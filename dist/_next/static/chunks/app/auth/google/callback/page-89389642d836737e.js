(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89],{9862:(e,r,t)=>{"use strict";t.d(r,{y:()=>c});var o=t(49509);let a=()=>{let e=window.location.origin;return{google:{clientId:o.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID||"your-google-client-id",redirectUri:o.env.NEXT_PUBLIC_GOOGLE_REDIRECT_URI||"".concat(e,"/auth/google/callback")},kakao:{clientId:o.env.NEXT_PUBLIC_KAKAO_CLIENT_ID||"your-kakao-client-id",redirectUri:o.env.NEXT_PUBLIC_KAKAO_REDIRECT_URI||"".concat(e,"/auth/kakao/callback")},naver:{clientId:o.env.NEXT_PUBLIC_NAVER_CLIENT_ID||"your-naver-client-id",redirectUri:o.env.NEXT_PUBLIC_NAVER_REDIRECT_URI||"".concat(e,"/auth/naver/callback")}}},i={loginWithGoogle:()=>{let e=a(),r="https://accounts.google.com/oauth/authorize?"+"client_id=".concat(e.google.clientId,"&")+"redirect_uri=".concat(encodeURIComponent(e.google.redirectUri),"&")+"response_type=code&scope=openid email profile&access_type=offline";window.location.href=r},loginWithKakao:()=>{let e=a();if(window.Kakao)window.Kakao.isInitialized()||window.Kakao.init(e.kakao.clientId),window.Kakao.Auth.authorize({redirectUri:e.kakao.redirectUri,scope:"profile_nickname,profile_image,account_email"});else{let r="https://kauth.kakao.com/oauth/authorize?"+"client_id=".concat(e.kakao.clientId,"&")+"redirect_uri=".concat(encodeURIComponent(e.kakao.redirectUri),"&")+"response_type=code&scope=profile_nickname,profile_image,account_email";window.location.href=r}},loginWithNaver:()=>{let e=a(),r=Math.random().toString(36).substring(2,15);sessionStorage.setItem("naver_state",r);let t="https://nid.naver.com/oauth2.0/authorize?"+"client_id=".concat(e.naver.clientId,"&")+"redirect_uri=".concat(encodeURIComponent(e.naver.redirectUri),"&")+"response_type=code&"+"state=".concat(r,"&")+"scope=name,email,profile_image";window.location.href=t}},s=[{id:"admin_spinmoll",email:"spinmoll@admin.com",name:"spinmoll (관리자)",provider:"email",avatar:"/placeholder.svg?height=40&width=40&text=Admin",role:"admin"}],n="crop_analysis_auth",c={login:async(e,r)=>{if(await new Promise(e=>setTimeout(e,1e3)),"spinmoll"===e&&"1234"===r){let e=s[0];return localStorage.setItem(n,JSON.stringify(e)),{success:!0,user:e}}let t=s.find(r=>r.email===e);return t&&r?(localStorage.setItem(n,JSON.stringify(t)),{success:!0,user:t}):{success:!1,error:"이메일 또는 비밀번호가 올바르지 않습니다."}},signup:async(e,r,t)=>{if(await new Promise(e=>setTimeout(e,1e3)),s.some(r=>r.email===e))return{success:!1,error:"이미 존재하는 이메일입니다."};let o={id:Math.random().toString(36).substr(2,9),email:e,name:t,provider:"email",role:"user"};return s.push(o),localStorage.setItem(n,JSON.stringify(o)),{success:!0,user:o}},socialLogin:async e=>{try{switch(e){case"google":i.loginWithGoogle();break;case"kakao":i.loginWithKakao();break;case"naver":i.loginWithNaver()}return{success:!0}}catch(r){return console.error("".concat(e," 로그인 오류:"),r),{success:!1,error:"".concat(e," 로그인에 실패했습니다.")}}},handleSocialCallback:async(e,r,t)=>{try{await new Promise(e=>setTimeout(e,1e3));let r={id:Math.random().toString(36).substr(2,9),email:"user@".concat(e,".com"),name:"".concat(e," 사용자"),provider:e,avatar:"/placeholder.svg?height=40&width=40&text=".concat(e.charAt(0).toUpperCase())};return s.push(r),localStorage.setItem(n,JSON.stringify(r)),{success:!0,user:r}}catch(e){return console.error("소셜 로그인 콜백 처리 오류:",e),{success:!1,error:"소셜 로그인 처리 중 오류가 발생했습니다."}}},logout:()=>{localStorage.removeItem(n),sessionStorage.removeItem(n),sessionStorage.removeItem("naver_state"),window.location.href="/"},getCurrentUser:()=>{try{let e=localStorage.getItem(n);return e?JSON.parse(e):null}catch(e){return null}}}},71040:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var o=t(95155),a=t(12115),i=t(35695),s=t(9862),n=t(94861);function c(){let e=(0,i.useRouter)(),r=(0,i.useSearchParams)(),{login:t}=(0,n.A)();return(0,a.useEffect)(()=>{(async()=>{let t=r.get("code"),o=r.get("error");if(o){console.error("Google 로그인 오류:",o),e.push("/login?error=google_login_failed");return}if(t)try{let r=await s.y.handleSocialCallback("google",t);r.success&&r.user?(localStorage.setItem("crop_analysis_auth",JSON.stringify(r.user)),e.push("/analysis")):e.push("/login?error=google_login_failed")}catch(r){console.error("Google 콜백 처리 오류:",r),e.push("/login?error=google_login_failed")}})()},[r,e]),(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-green-600",children:"Google 로그인 처리 중..."})]})})}},94861:(e,r,t)=>{"use strict";t.d(r,{A:()=>c,AuthProvider:()=>n});var o=t(95155),a=t(12115),i=t(9862);let s=(0,a.createContext)(void 0);function n(e){let{children:r}=e,[t,n]=(0,a.useState)(null),[c,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{n(i.y.getCurrentUser()),l(!1)},[]);let u=async(e,r)=>{let t=await i.y.login(e,r);return t.success&&t.user&&n(t.user),{success:t.success,error:t.error}},d=async(e,r,t)=>{let o=await i.y.signup(e,r,t);return o.success&&o.user&&n(o.user),{success:o.success,error:o.error}},g=async e=>{let r=await i.y.socialLogin(e);return r.success&&r.user&&n(r.user),{success:r.success,error:r.error}};return(0,o.jsx)(s.Provider,{value:{user:t,isAuthenticated:!!t,login:u,signup:d,socialLogin:g,logout:()=>{i.y.logout(),n(null),localStorage.removeItem("crop_analysis_auth")},loading:c},children:r})}function c(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},98483:(e,r,t)=>{Promise.resolve().then(t.bind(t,71040))}},e=>{var r=r=>e(e.s=r);e.O(0,[96,358],()=>r(98483)),_N_E=e.O()}]);