(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[146],{9862:(e,r,t)=>{"use strict";t.d(r,{y:()=>s});var o=t(49509);let a=()=>{let e=window.location.origin;return{google:{clientId:o.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID||"your-google-client-id",redirectUri:o.env.NEXT_PUBLIC_GOOGLE_REDIRECT_URI||"".concat(e,"/auth/google/callback")},kakao:{clientId:o.env.NEXT_PUBLIC_KAKAO_CLIENT_ID||"your-kakao-client-id",redirectUri:o.env.NEXT_PUBLIC_KAKAO_REDIRECT_URI||"".concat(e,"/auth/kakao/callback")},naver:{clientId:o.env.NEXT_PUBLIC_NAVER_CLIENT_ID||"your-naver-client-id",redirectUri:o.env.NEXT_PUBLIC_NAVER_REDIRECT_URI||"".concat(e,"/auth/naver/callback")}}},i={loginWithGoogle:()=>{let e=a(),r="https://accounts.google.com/oauth/authorize?"+"client_id=".concat(e.google.clientId,"&")+"redirect_uri=".concat(encodeURIComponent(e.google.redirectUri),"&")+"response_type=code&scope=openid email profile&access_type=offline";window.location.href=r},loginWithKakao:()=>{let e=a();if(window.Kakao)window.Kakao.isInitialized()||window.Kakao.init(e.kakao.clientId),window.Kakao.Auth.authorize({redirectUri:e.kakao.redirectUri,scope:"profile_nickname,profile_image,account_email"});else{let r="https://kauth.kakao.com/oauth/authorize?"+"client_id=".concat(e.kakao.clientId,"&")+"redirect_uri=".concat(encodeURIComponent(e.kakao.redirectUri),"&")+"response_type=code&scope=profile_nickname,profile_image,account_email";window.location.href=r}},loginWithNaver:()=>{let e=a(),r=Math.random().toString(36).substring(2,15);sessionStorage.setItem("naver_state",r);let t="https://nid.naver.com/oauth2.0/authorize?"+"client_id=".concat(e.naver.clientId,"&")+"redirect_uri=".concat(encodeURIComponent(e.naver.redirectUri),"&")+"response_type=code&"+"state=".concat(r,"&")+"scope=name,email,profile_image";window.location.href=t}},n=[{id:"admin_spinmoll",email:"spinmoll@admin.com",name:"spinmoll (관리자)",provider:"email",avatar:"/placeholder.svg?height=40&width=40&text=Admin",role:"admin"}],c="crop_analysis_auth",s={login:async(e,r)=>{if(await new Promise(e=>setTimeout(e,1e3)),"spinmoll"===e&&"1234"===r){let e=n[0];return localStorage.setItem(c,JSON.stringify(e)),{success:!0,user:e}}let t=n.find(r=>r.email===e);return t&&r?(localStorage.setItem(c,JSON.stringify(t)),{success:!0,user:t}):{success:!1,error:"이메일 또는 비밀번호가 올바르지 않습니다."}},signup:async(e,r,t)=>{if(await new Promise(e=>setTimeout(e,1e3)),n.some(r=>r.email===e))return{success:!1,error:"이미 존재하는 이메일입니다."};let o={id:Math.random().toString(36).substr(2,9),email:e,name:t,provider:"email",role:"user"};return n.push(o),localStorage.setItem(c,JSON.stringify(o)),{success:!0,user:o}},socialLogin:async e=>{try{switch(e){case"google":i.loginWithGoogle();break;case"kakao":i.loginWithKakao();break;case"naver":i.loginWithNaver()}return{success:!0}}catch(r){return console.error("".concat(e," 로그인 오류:"),r),{success:!1,error:"".concat(e," 로그인에 실패했습니다.")}}},handleSocialCallback:async(e,r,t)=>{try{await new Promise(e=>setTimeout(e,1e3));let r={id:Math.random().toString(36).substr(2,9),email:"user@".concat(e,".com"),name:"".concat(e," 사용자"),provider:e,avatar:"/placeholder.svg?height=40&width=40&text=".concat(e.charAt(0).toUpperCase())};return n.push(r),localStorage.setItem(c,JSON.stringify(r)),{success:!0,user:r}}catch(e){return console.error("소셜 로그인 콜백 처리 오류:",e),{success:!1,error:"소셜 로그인 처리 중 오류가 발생했습니다."}}},logout:()=>{localStorage.removeItem(c),sessionStorage.removeItem(c),sessionStorage.removeItem("naver_state"),window.location.href="/"},getCurrentUser:()=>{try{let e=localStorage.getItem(c);return e?JSON.parse(e):null}catch(e){return null}}}},57990:(e,r,t)=>{Promise.resolve().then(t.bind(t,94985))},94985:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var o=t(95155),a=t(12115),i=t(35695),n=t(9862);function c(){let e=(0,i.useRouter)(),r=(0,i.useSearchParams)();return(0,a.useEffect)(()=>{(async()=>{let t=r.get("code"),o=r.get("state"),a=r.get("error"),i=sessionStorage.getItem("naver_state");if(a){console.error("Naver 로그인 오류:",a),e.push("/login?error=naver_login_failed");return}if(o!==i){console.error("Naver 로그인 state 불일치"),e.push("/login?error=naver_login_failed");return}if(t)try{let r=await n.y.handleSocialCallback("naver",t,o);r.success&&r.user?(localStorage.setItem("crop_analysis_auth",JSON.stringify(r.user)),e.push("/analysis")):e.push("/login?error=naver_login_failed")}catch(r){console.error("Naver 콜백 처리 오류:",r),e.push("/login?error=naver_login_failed")}})()},[r,e]),(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-green-600",children:"Naver 로그인 처리 중..."})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[96,358],()=>r(57990)),_N_E=e.O()}]);